---
title: "Od uzorka do populacije"
subtitle: "Poglavlje 3: Osnove statističkog zaključivanja"
author: "Metode istraživanja masovne komunikacije"
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    code-fold: true
    theme: cosmo
  pdf:
    documentclass: article
    geometry: margin=1in
    fontsize: 12pt
    number-sections: true
lang: hr
---

# Od uzorka do populacije {#sec-uzorak-populacija}

Istraživač medija rijetko ima priliku analizirati cijelu populaciju koja ga zanima. Kada istražujemo percepciju kredibiliteta vijesti među hrvatskim građanima, ne možemo anketirati svih 4 milijuna odraslih osoba. Umjesto toga, prikupljamo **uzorak** – možda 500 ili 1000 ispitanika – i na temelju tog uzorka pokušavamo izvesti zaključke o cijeloj **populaciji**. Ova tranzicija od konkretnih podataka koje imamo prema općenitim zaključkama koje želimo predstavlja srž **statističkog zaključivanja**. U ovom poglavlju razmatrat ćemo teorijske temelje koji omogućuju ovaj skok od uzorka do populacije. Započet ćemo s normalnom distribucijom, najvažnijom teorijskom distribucijom u statistici. Zatim ćemo razmotriti centralni granični teorem, koji objašnjava zašto prosjeci uzoraka imaju predvidljivo ponašanje. Konačno, upoznat ćemo standardnu pogrešku i osnovne principe testiranja hipoteza, koji zajedno čine temelj inferenc ijalne statistike.

## Normalna distribucija {#sec-normalna-distribucija}

Kada crtamo histogram dnevne gledanosti televizijskih vijesti, vremena provedenog na društvenim mrežama ili ocjena kvalitete članaka, često primjećujemo da distribucija ima karakterističan oblik: podaci se grupiraju oko srednje vrijednosti, s postepenim opadanjem prema ekstremima s obje strane. Ovaj obrazac toliko često se pojavljuje u prirodi i društvenim znanostima da dobiva poseban status u statistici. Naziva se **normalna distribucija** ili "zvonasta krivulja" (engl. *bell curve*), i predstavlja najvažniju teorijsku distribuciju u svim statistikama.

### Karakteristike normalne distribucije {#sec-karakteristike-normalne}

Normalna distribucija je **kontinuirana** distribucija, što znači da može poprimiti bilo koju vrijednost unutar svog raspona, ne samo diskretne brojeve. Za razliku od binomne distribucije gdje možemo dobiti točno 3 ili 4 uspjeha (ali ne 3.5), varijable poput vremena čitanja ili gledanosti mogu poprimiti bilo koju vrijednost. Normalna distribucija potpuno je određena s dva parametra: **sredinom** $\mu$ (čita se "mi") i **standardnom devijacijom** $\sigma$ (čita se "sigma"). Sredina određuje gdje je distribucija centrirana na brojčanoj osi, dok standardna devijacija određuje koliko je distribucija "raširena" ili "široka".

Matematičku notaciju za normalnu distribuciju pišemo ovako:

$$X \sim \text{Normal}(\mu, \sigma)$$ {#eq-normal-notation}

što se čita: "varijabla X slijedi normalnu distribuciju sa sredinom $\mu$ i standardnom devijacijom $\sigma$". Ako kažemo da prosječno vrijeme čitanja članaka na Indexu slijedi normalnu distribuciju sa sredinom od 120 sekundi i standardnom devijacijom od 30 sekundi, zapisali bismo: $X \sim \text{Normal}(120, 30)$.

```{r}
#| label: fig-normal-basic
#| echo: true
#| eval: false
#| fig-cap: "Standardna normalna distribucija"

# Kreiranje standardne normalne distribucije (μ=0, σ=1)
x <- seq(-4, 4, by = 0.01)
y <- dnorm(x, mean = 0, sd = 1)

plot(x, y, type = "l", lwd = 2, col = "blue",
     main = "Standardna normalna distribucija",
     xlab = "Vrijednost (z-score)",
     ylab = "Gustoća vjerojatnosti",
     las = 1)

# Označavanje empirijskog pravila
abline(v = c(-1, 1), lty = 2, col = "red")
abline(v = c(-2, 2), lty = 2, col = "darkgreen")
text(0, 0.2, "68% podataka\nwithin ±1 SD", cex = 0.8)
```

### Empirijsko pravilo {#sec-empirijsko-pravilo}

Neovisno o konkretnim vrijednostima sredine i standardne devijacije, sve normalne distribucije dijele važna svojstva. **Empirijsko pravilo** (također poznato kao pravilo 68-95-99.7) govori nam:

- Približno **68%** opservacija pada unutar jedne standardne devijacije od sredine ($\mu \pm \sigma$)
- Približno **95%** opservacija pada unutar dvije standardne devijacije od sredine ($\mu \pm 2\sigma$)
- Približno **99.7%** opservacija pada unutar tri standardne devijacije od sredine ($\mu \pm 3\sigma$)

Za konkretni primjer, pretpostavimo da prosječno vrijeme čitanja članaka na Index.hr slijedi normalnu distribuciju s $\mu = 120$ sekundi i $\sigma = 30$ sekundi. Prema empirijskom pravilu, 68% čitatelja provodi između 90 i 150 sekundi (120 ± 30), 95% između 60 i 180 sekundi (120 ± 60), i gotovo svi (99.7%) između 30 i 210 sekundi (120 ± 90). Ovo pravilo omogućuje brzu procjenu normalnosti distribucije: ako su naši stvarni podaci vrlo daleko od ovih postotaka, možda distribucija nije normalna.

### Vjerojatnosti i površine ispod krivulje {#sec-vjerojatnosti-povrsine}

Za kontinuirane distribucije poput normalne, vjerojatnost ne pripisujemo pojedinačnim točkama već intervalima. Pitanje "kolika je vjerojatnost da čitatelj provede točno 120.0000 sekundi" nema smisla – odgovor je nula. Međutim, pitanje "kolika je vjerojatnost da čitatelj provede između 110 i 130 sekundi" ima jasan odgovor, i taj odgovor daje nam **površina ispod krivulje** između tih dviju točaka.

U R-u koristimo `pnorm()` funkciju za izračun kumulativnih vjerojatnosti. Na primjer, koliki postotak čitatelja provodi manje od 100 sekundi ako je $\mu = 120$ i $\sigma = 30$?

```{r}
#| label: fig-pnorm-example
#| echo: true
#| eval: false

# Vjerojatnost da je X < 100 kada je μ=120, σ=30
vjerojatnost <- pnorm(100, mean = 120, sd = 30)
print(paste("Vjerojatnost:", round(vjerojatnost, 3)))

# Ovo odgovara približno 25.2% čitatelja
```

Funkcija `qnorm()` radi obrnuto: za danu vjerojatnost vraća odgovarajuću vrijednost. Koji je prag vremena čitanja ispod kojeg pada 25% čitatelja?

```{r}
#| label: fig-qnorm-example
#| echo: true
#| eval: false

# Vrijednost ispod koje pada 25% podataka
prag <- qnorm(0.25, mean = 120, sd = 30)
print(paste("25. percentil:", round(prag, 1), "sekundi"))
```

## Centralni granični teorem {#sec-cgt}

Postavimo sada fundamentalno pitanje: što se događa kada uzimamo uzorke iz populacije i izračunavamo prosjeke tih uzoraka? Zamislimo da ponavljamo anketiranje publike HRT-a. Prvi tjedan anketiramo 50 gledatelja i dobijemo prosječnu satisfakciju od 7.2 (na skali 1-10). Sljedeći tjedan ponovo anketiramo 50 različitih gledatelja i dobijemo 7.5. Treći tjedan dobijemo 6.9. Ako bismo ovaj proces ponavljali stotinama puta, što bismo vidjeli? Distribucija svih tih prosječnih satisfakcija naziva se **uzorkovna distribucija prosjeka** (engl. *sampling distribution of the mean*), i ona ima zadivljujuća svojstva koja nam objašnjava centralni granični teorem.

### Uzorkovna distribucija prosjeka {#sec-uzorkovna-distribucija}

Razmotrimo konkretan primjer. Pretpostavimo da stvarna prosječna satisfakcija svih HRT gledatelja (populacijska sredina) iznosi $\mu = 7.0$, sa standardnom devijacijom $\sigma = 2.0$. Ako uzmemo uzorak od $N = 50$ gledatelja i izračunamo prosječnu satisfakciju, gotovo sigurno nećemo dobiti točno 7.0. Možda dobijemo 7.3, ili 6.8, ili neku drugu vrijednost. Nadalje, ako ponovimo eksperiment s novim uzorkom od 50 ljudi, dobivamo drugu vrijednost. Distribucija svih mogućih prosječnih satisfakcija iz uzoraka veličine 50 jest uzorkovna distribucija prosjeka.

Ključno pitanje: kako izgleda ova distribucija? Odgovor daje **centralni granični teorem** (CGT), jedan od najvažnijih rezultata u teoriji vjerojatnosti. Teorem kaže sljedeće: bez obzira kakav oblik ima originalna populacijska distribucija, uzorkovna distribucija prosjeka postaje sve normalnija kako se veličina uzorka povećava. Štav iše, CGT nam daje precizne formule za karakteristike ove distribucije.

### Tri ključna rezultata CGT-a {#sec-tri-rezultata-cgt}

Centralni granični teorem donosi tri fundamentalna rezultata o uzorkovnoj distribuciji prosjeka:

**Prvo**, sredina uzorkovne distribucije jednaka je populacijskoj sredini. Ako je prava prosječna satisfakcija $\mu = 7.0$, tada je prosječna vrijednost svih mogućih prosječnih satisfakcija iz uzoraka također 7.0. Formalno: $E[\bar{X}] = \mu$. Ovo znači da je prosječna satisfakcija iz uzorka **nepristrani procjenitelj** (unbiased estimator) populacijske sredine – u prosjeku, "pogađa" pravu vrijednost.

**Drugo**, standardna devijacija uzorkovne distribucije (koja se naziva **standardna pogreška**) jednaka je:

$$\text{SE} = \frac{\sigma}{\sqrt{N}}$$ {#eq-standard-error}

gdje je $\sigma$ populacijska standardna devijacija, a $N$ veličina uzorka. U našem primjeru s HRT-om, ako je $\sigma = 2.0$ i $N = 50$:

$$\text{SE} = \frac{2.0}{\sqrt{50}} = \frac{2.0}{7.07} \approx 0.283$$

Ova formula ima važne implikacije. Standardna pogreška se smanjuje s korijenom veličine uzorka, ne linearno. Da bismo prepolovili standardnu pogrešku, moramo učetverostručiti veličinu uzorka. Posljedično tome, povećanje preciznosti postaje sve skuplje kako uzorak raste.

**Treće**, kako veličina uzorka raste, oblik uzorkovne distribucije sve više nalikuje normalnoj distribuciji, neovisno o obliku populacijske distribucije. Čak i ako je originalna distribucija satisfakcije asimetrična ili multimodalna, distribucija prosječnih satisfakcija iz uzoraka veličine 30 ili više bit će približno normalna.

```{r}
#| label: fig-clt-demonstration
#| echo: true
#| eval: false
#| fig-cap: "Demonstracija centralnog graničnog teorema"

# Simulacija: uzimamo mnogo uzoraka i gledamo distribuciju prosjeka
set.seed(123)
n_simulations <- 10000
sample_size <- 50
population_mean <- 7.0
population_sd <- 2.0

# Generiranje 10,000 prosječnih satisfakcija iz uzoraka
sample_means <- replicate(n_simulations, {
  sample <- rnorm(sample_size, mean = population_mean, sd = population_sd)
  mean(sample)
})

# Histogram uzorkovne distribucije
hist(sample_means, breaks = 50, probability = TRUE,
     main = "Uzorkovna distribucija prosjeka (N=50)",
     xlab = "Prosječna satisfakcija",
     ylab = "Gustoća",
     col = "lightblue", border = "white")

# Dodavanje teorijske normalne krivulje
se <- population_sd / sqrt(sample_size)
x <- seq(min(sample_means), max(sample_means), length = 100)
lines(x, dnorm(x, mean = population_mean, sd = se), 
      col = "red", lwd = 2)

legend("topright", legend = c("Simulirana", "Teorijska"),
       col = c("lightblue", "red"), lwd = c(10, 2))
```

### Praktične implikacije {#sec-prakticne-implikacije-cgt}

CGT ima duboke implikacije za istraživanje medija. **Prvo**, omogućuje nam korištenje normalne distribucije za inferencijalnu statistiku čak i kada naši originalni podaci nisu normalno distribuirani. Satisfakcija se mjeri na Likertovoj skali (1-10) koja nije striktno kontinuirana, ali CGT nam kaže da je distribucija prosječne satisfakcije iz uzorka dovoljno velika biti će približno normalna.

**Drugo**, formula za standardnu pogrešku daje nam kvantitativnu mjeru koliko možemo biti sigurni u naš uzorkovni prosjek. Manji uzorak znači veću standardnu pogrešku, što znači veću nesigurnost. Veći uzorak znači manju standardnu pogrešku i veću preciznost. Ovo opravdava intuiciju da su "veći uzorci bolji" – ali također pokazuje da ta prednost opada s korijenom veličine uzorka.

**Treće**, CGT objašnjava zašto toliko statističkih testova pretpostavlja normalnost. Ne zahtijevamo da originalni podaci budu normalni, već da uzorkovna distribucija testne statistike (koja je često bazirana na prosjeku) bude normalna, a to nam CGT jamči za dovoljno velike uzorke.

## Standardna pogreška {#sec-standardna-pogreska}

Kada izvještavamo rezultate istraživanja, često navodimo prosječnu vrijednost: "Prosječna gledanost iznosi 285.000 gledatelja" ili "Prosječna ocjena kredibiliteta je 6.5 na skali 1-10". Međutim, ove brojke su procjene bazirane na uzorcima, a svaki uzorak donosi određenu količinu nesigurnosti. **Standardna pogreška** kvantificira tu nesigurnost – govori nam koliko tipično odstupa prosječna vrijednost iz uzorka od prave populacijske vrijednosti.

### Razlika između SD i SE {#sec-razlika-sd-se}

Studenti često brka ju standardnu devijaciju (SD) i standardnu pogrešku (SE), jer su konceptualno povezane ali mjere različite stvari. **Standardna devijacija** mjeri varijabilnost pojedinačnih opservacija oko prosjeka. Ako kažemo da gledanost emisije ima SD = 42.000, govorimo o tome koliko gledanost varira od emisije do emisije u našem skupu podataka.

**Standardna pogreška** mjeri varijabilnost **prosječne vrijednosti uzorka** oko populacijske sredine. Ona odgovara na pitanje: ako bismo ponavljali naše istraživanje mnogo puta, koliko bi varirali dobiveni prosjeci? Standardna pogreška je uvijek manja od standardne devijacije (osim kada je $N = 1$), i postaje sve manja kako povećavamo veličinu uzorka.

Formula koju smo već vidjeli:

$$\text{SE} = \frac{\sigma}{\sqrt{N}}$$ {#eq-se-formula}

Problem je što u praksi ne znamo populacijsku standardnu devijaciju $\sigma$. Umjesto toga, moramo je procijeniti iz našeg uzorka. Uzorkovnu standardnu devijaciju označavamo s $s$, a procijenjenu standardnu pogrešku tada računamo kao:

$$\widehat{\text{SE}} = \frac{s}{\sqrt{N}}$$ {#eq-se-estimate}

gdje je $s$ standardna devijacija našeg uzorka, a $N$ veličina uzorka. Simbol $\widehat{\text{SE}}$ ("SE šešir") naglašava da se radi o procjeni, ne pravoj vrijednosti.

### Primjer izračuna {#sec-primjer-izracuna-se}

Analiziramo gledanost 30 epizoda serije na HRT-u. Prosječna gledanost je $\bar{X} = 182.000$ gledatelja, sa standardnom devijacijom $s = 28.000$. Standardna pogreška prosjeka je:

$$\widehat{\text{SE}} = \frac{28.000}{\sqrt{30}} = \frac{28.000}{5.48} \approx 5.109$$

Ova brojka nam govori: ako bismo ponavljali istraživanje (uzimajući različite uzorke od 30 epizoda), prosječna gledanost u tim uzorcima tipično bi odstupala oko 5.100 gledatelja od prave populacijske sredine.

```{r}
#| label: fig-se-calculation
#| echo: true
#| eval: false

# Podaci o gledanosti (u tisućama)
gledanost <- c(180, 165, 195, 170, 190, 182, 175, 188, 192, 168,
               178, 185, 201, 172, 186, 179, 194, 181, 177, 183,
               189, 174, 196, 169, 187, 191, 176, 184, 173, 198)

# Deskriptivne statistike
mean_gledanost <- mean(gledanost)
sd_gledanost <- sd(gledanost)
n <- length(gledanost)

# Standardna pogreška
se_gledanost <- sd_gledanost / sqrt(n)

cat("Prosječna gledanost:", round(mean_gledanost, 1), "tisuća\n")
cat("Standardna devijacija:", round(sd_gledanost, 1), "tisuća\n")
cat("Standardna pogreška:", round(se_gledanost, 2), "tisuća\n")
cat("95% interval pouzdanosti:", 
    round(mean_gledanost - 1.96*se_gledanost, 1), "do",
    round(mean_gledanost + 1.96*se_gledanost, 1), "tisuća\n")
```

### Intervali pouzdanosti {#sec-intervali-pouzdanosti}

Standardna pogreška prirodno vodi prema **intervalima pouzdanosti** (confidence intervals). Budući da uzorkovna distribucija prosjeka slijedi (približno) normalnu distribuciju, možemo konstruirati interval unutar kojeg se s određenom vjerojatnošću nalazi prava populacijska sredina. Najčešće korišteni interval je **95% interval pouzdanosti**, koji se izračunava kao:

$$\text{95% IP} = \bar{X} \pm 1.96 \times \widehat{\text{SE}}$$ {#eq-confidence-interval}

Za naš primjer gledanosti:

$$\text{95% IP} = 182 \pm 1.96 \times 5.1 = 182 \pm 10 = [172, 192]$$

Interpretacija: Ako bismo ponavljali ovo istraživanje mnogo puta i svaki put konstruirali 95% interval pouzdanosti, približno 95% tih intervala bi sadržavalo pravu populacijsku sredinu. Valja naglasiti ono što interval **ne** znači: ne možemo reći "postoji 95% šanse da je prava sredina između 172 i 192" jer prava sredina je fiksna vrijednost (koja ili jest ili nije u tom intervalu). Međutim, metoda koju koristimo za konstrukciju intervala "uspijeva" 95% vremena.

## Testiranje hipoteza {#sec-testiranje-hipoteza}

Vrhunac ovog poglavlja jest razumijevanje kako zapravo testiramo hipoteze statistički. Pretpostavimo da HRT tvrdi da prosječna gledanost njihovih večernjih vijesti iznosi 300.000 gledatelja. Mi provedemo istraživanje na uzorku od 50 emisija i dobijemo prosječnu gledanost od 285.000 sa standardnom devijacijom od 42.000. Trebamo li smatrati da tvrdnja HRT-a nije točna, ili je razlika od 15.000 gledatelja samo slučajno odstupanje zbog uzorkovanja? **Testiranje hipoteza** pruža sistematičan okvir za odgovaranje na takva pitanja.

### Nul-hipoteza i alternativna hipoteza {#sec-nul-alternativna}

Svaki statistički test započinje s dvije konkurentske hipoteze. **Nul-hipoteza** (označava se $H_0$, čita se "ha nula") predstavlja status quo ili tvrdnju koju želimo testirati. U našem primjeru:

$$H_0: \mu = 300.000$$

što čitamo: "nul-hipoteza je da prava prosječna gledanost iznosi 300.000 gledatelja". **Alternativna hipoteza** ($H_1$ ili $H_A$) predstavlja ono što sumnjamo da je istina ako nul-hipoteza nije točna. Može biti dvosmjerna:

$$H_1: \mu \neq 300.000$$

ili jednosmjerna (npr. $H_1: \mu < 300.000$ ako posebno sumnjamo da HRT precjenjuje gledanost).

### Logika testiranja {#sec-logika-testiranja}

Logika testiranja hipoteza temelji se na reductio ad absurdum argumentaciji. Privremeno **pretpostavljamo da je nul-hipoteza istinita**. Zatim se pitamo: ako je nul-hipoteza istinita, kolika je vjerojatnost da bismo opazili podatke ekstremne kao ili ekstremenije od onih koje smo zapravo opazili? Ako je ta vjerojatnost vrlo niska (obično ispod 5%), zaključujemo da su naši podaci nespojivi s nul-hipotezom i **odbacujemo** nul-hipotezu. Ako vjerojatnost nije dovoljno niska, **ne odbacujemo** nul-hipotezu (ne kažemo da je "prihvaćamo", već samo da nemamo dovoljno dokaza protiv nje).

### Z-test: primjer {#sec-z-test-primjer}

Najjednostavniji test je **z-test** za prosjek kada znamo populacijsku standardnu devijaciju (što u praksi rijetko znamo, ali ovaj test služi kao didaktički uvod). Testna statistika je:

$$z = \frac{\bar{X} - \mu_0}{\sigma / \sqrt{N}}$$ {#eq-z-test}

gdje je $\bar{X}$ prosječna vrijednost iz uzorka, $\mu_0$ je vrijednost koju testiramo (iz nul-hipoteze), $\sigma$ je poznata populacijska standardna devijacija, i $N$ je veličina uzorka. Ova z-vrijednost govori nam koliko standardnih pogrešaka je naš opaženi prosjek udaljen od pretpostavljene vrijednosti.

Za naš primjer, pretpostavimo da znamo (iz prošlih podataka) da je populacijska SD = 42.000:

$$z = \frac{285.000 - 300.000}{42.000 / \sqrt{50}} = \frac{-15.000}{5.940} \approx -2.53$$

Naš opaženi prosjek je 2.53 standardne pogreške ispod tvrdnje HRT-a. Je li to dovoljno ekstremno da odbacimo nul-hipotezu?

### P-vrijednost {#sec-p-vrijednost}

**P-vrijednost** (p-value) je vjerojatnost dobivanja rezultata ekstremnih kao ili ekstremnih od onih koje smo opazili, pod pretpostavkom da je nul-hipoteza istinita. Za dvosmjerni test s $z = -2.53$:

```{r}
#| label: fig-p-value
#| echo: true
#| eval: false

# Izračun p-vrijednosti za z = -2.53
z <- -2.53

# Za dvosmjerni test, gledamo obje strane distribucije
p_value <- 2 * pnorm(z)
print(paste("P-vrijednost:", round(p_value, 4)))
```

P-vrijednost je približno 0.011 ili 1.1%. Interpretacija: Ako bi prava prosječna gledanost bila 300.000, tada bismo u samo 1.1% slučajeva dobili prosjek koji je toliko ili više udaljen od 300.000 kao što je naš opaženi prosjek od 285.000. Budući da je ova vjerojatnost ispod uobičajenog praga od 5% (**razina značajnosti** $\alpha = 0.05$), odbacujemo nul-hipotezu. Zaključujemo da imamo statističke dokaze da prava prosječna gledanost nije 300.000 gledatelja.

### Moć testa i pogreške {#sec-moc-i-pogreske}

Testiranje hipoteza nije savršeno. Postoje dva tipa pogrešaka:

- **Pogreška tipa I** (lažno pozitivan): odbacujemo istinitu nul-hipotezu. Vjerojatnost ove pogreške je $\alpha$ (obično 0.05).
- **Pogreška tipa II** (lažno negativan): ne odbacujemo lažnu nul-hipotezu. Vjerojatnost ove pogreške označavamo s $\beta$.

**Moć testa** je $1 - \beta$ – vjerojatnost da ćemo ispravno odbaciti lažnu nul-hipotezu. Moć raste s veličinom uzorka, veličinom stvarnog efekta, i manjom varijabilnošću.

::: {.callout-warning}
## Česta pogrešna interpretacija

P-vrijednost od 0.01 **ne** znači "postoji 1% šanse da je nul-hipoteza istinita". P-vrijednost pretpostavlja da je nul-hipoteza istinita i mjeri ekstremnost podataka, ne vjerojatnost hipoteza. Pravilna interpretacija: "Ako bi nul-hipoteza bila istinita, podaci ekstremni kao naši ili ekstremije javljali bi se u 1% slučajeva."
:::

```{r}
#| label: fig-hypothesis-test-visual
#| echo: true
#| eval: false
#| fig-cap: "Vizualizacija testiranja hipoteza"

# Crtanje distribucije pod nul-hipotezom
mu0 <- 300  # Pretpostavljena sredina (H0)
se <- 42 / sqrt(50)  # Standardna pogreška
x_obs <- 285  # Opažena sredina

x <- seq(mu0 - 4*se, mu0 + 4*se, length = 200)
y <- dnorm(x, mean = mu0, sd = se)

plot(x, y, type = "l", lwd = 2,
     main = "Testiranje H0: μ = 300",
     xlab = "Prosječna gledanost (tisuće)",
     ylab = "Gustoća",
     las = 1)

# Označavanje kritičnih regija (α = 0.05, dvosmjerni test)
crit_lower <- mu0 - 1.96 * se
crit_upper <- mu0 + 1.96 * se

# Senčanje odbacivanja regija
x_reject_lower <- seq(mu0 - 4*se, crit_lower, length = 100)
polygon(c(x_reject_lower, rev(x_reject_lower)),
        c(dnorm(x_reject_lower, mu0, se), rep(0, 100)),
        col = rgb(1, 0, 0, 0.3), border = NA)

x_reject_upper <- seq(crit_upper, mu0 + 4*se, length = 100)
polygon(c(x_reject_upper, rev(x_reject_upper)),
        c(dnorm(x_reject_upper, mu0, se), rep(0, 100)),
        col = rgb(1, 0, 0, 0.3), border = NA)

# Označavanje opažene vrijednosti
abline(v = x_obs, col = "blue", lwd = 2, lty = 2)
text(x_obs, max(y)*0.8, "Opaženo:\n285", col = "blue", cex = 0.9)

# Legenda
legend("topright", 
       legend = c("H0 distribucija", "Odbacivanje regija (α=0.05)", "Opažena vrijednost"),
       col = c("black", "red", "blue"),
       lwd = c(2, 10, 2),
       lty = c(1, 1, 2))
```

## Sažetak {.unnumbered}

U ovom poglavlju postavili smo teorijske temelje za statisticko zaključivanje:

- **Normalna distribucija** – zvonasta krivulja određena s $\mu$ i $\sigma$, temelj inferenc ijalne statistike
  - Empirijsko pravilo: 68-95-99.7% unutar 1-2-3 standardne devijacije
  - Vjerojatnosti kao površine ispod krivulje

- **Centralni granični teorem** – uzorkovna distribucija prosjeka postaje normalna kako $N$ raste
  - Sredina uzorkovne distribucije: $E[\bar{X}] = \mu$
  - Standardna pogreška: $\text{SE} = \sigma/\sqrt{N}$
  - Opravdava korištenje normalne distribucije u testovima

- **Standardna pogreška** – mjeri nesigurnost procjene prosjeka
  - Razlika od SD: SE mjeri varijabilnost prosjeka, ne pojedinačnih opservacija
  - Temelj za intervale pouzdanosti: $\bar{X} \pm 1.96 \times \text{SE}$

- **Testiranje hipoteza** – sistematičan okvir za statističke zaključke
  - Nul-hipoteza ($H_0$) vs. alternativna ($H_1$)
  - P-vrijednost mjeri ekstremnost podataka pod $H_0$
  - Odbacujemo $H_0$ ako $p < \alpha$ (obično 0.05)

Ovi koncepti čine temelj svih statističkih testova koje ćemo koristiti u analizi komunikoloških podataka.

## Reference {.unnumbered}

::: {#refs}
:::
